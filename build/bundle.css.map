{
  "version": 3,
  "file": "bundle.css",
  "sources": [
    "../../App.svelte",
    "../../Guia.svelte",
    "../../List.svelte",
    "../../Map.svelte"
  ],
  "sourcesContent": [
    "<style lang=\"scss\">main {\n  display: flex;\n  justify-content: space-around;\n  height: 100%; }\n\n.left {\n  width: 30%;\n  height: 100%; }\n  @media (max-width: 460px) {\n    .left {\n      display: none; } }\n\n.right {\n  width: 70%;\n  height: 100%; }\n  @media (max-width: 460px) {\n    .right {\n      width: 100%; } }</style>\n\n<script>\n  import gs2json from './utils.js'\n  import List from './List.svelte'\n  import { claves, routes, filteredRoutes } from './store.js'\n  import Map from './Map.svelte'\n\n  let parsedClaves\n  let parsedRoutes\n\n  // Sentry.init({\n  //   dsn:\n  //     'https://71d2baf50eb145e9aba10e189286047b@o416341.ingest.sentry.io/5310674',\n  // })\n\n  const fetchData = (async () => {\n    const responseClaves = await fetch(\n      `https://spreadsheets.google.com/feeds/cells/1ia-bi_1oIuVbNGtAWsQbF6jrUMp1ef7AuGhepLfTxqM/1/public/full?alt=json`\n    )\n\n    const responseRoutes = await fetch(\n      `https://spreadsheets.google.com/feeds/cells/1ia-bi_1oIuVbNGtAWsQbF6jrUMp1ef7AuGhepLfTxqM/2/public/full?alt=json`\n    )\n\n    const jsonClaves = await responseClaves.json()\n    const jsonRoutes = await responseRoutes.json()\n    parsedClaves = gs2json(jsonClaves)\n    parsedRoutes = gs2json(jsonRoutes)\n    claves.set(parsedClaves)\n    routes.set(parsedRoutes)\n    filteredRoutes.set(parsedClaves)\n    return parsedClaves\n  })()\n</script>\n\n<main>\n  {#await fetchData}\n    <div class=\"loading\">\n      <p>carregando...</p>\n    </div>\n  {:then}\n    <div class=\"left\">\n      <List />\n    </div>\n    <div class=\"right\">\n      <Map />\n    </div>\n  {/await}\n</main>\n",
    "<style lang=\"scss\">.embed-container {\n  position: relative;\n  padding-bottom: 56.25%;\n  height: 0;\n  overflow: hidden;\n  max-width: 100%; }\n\n.embed-container iframe,\n.embed-container object,\n.embed-container embed {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%; }\n\n.guia {\n  min-height: 100vh; }\n  .guia .body {\n    display: flex;\n    flex-direction: column;\n    align-items: center; }\n\nh1 {\n  text-align: center; }\n\nsmall {\n  color: #8e8e8e;\n  display: block; }\n\ncanvas {\n  width: 200px;\n  height: 200px; }\n\np {\n  padding: 0 20px; }\n\n@media (max-width: 460px) {\n  .guia {\n    position: absolute;\n    bottom: 0px;\n    height: 80px;\n    min-height: 80px;\n    display: block;\n    width: 100%;\n    background: white;\n    z-index: 2; }\n    .guia.active {\n      bottom: 200px; }\n    .guia .body {\n      display: flex;\n      flex-direction: row;\n      justify-content: space-between;\n      align-items: center;\n      padding: 0 20px; }\n  iframe {\n    width: 100%; }\n  canvas {\n    width: 80px;\n    height: 80px; }\n  h1 {\n    text-align: left;\n    font-size: 18px; } }</style>\n\n<script>\n  import { onMount, afterUpdate } from 'svelte'\n  import Clavis from './clavis.js'\n  //import Youtube from '@sveltecasts/svelte-youtube'\n  const clavis = new Clavis()\n  let canvas\n  let screenWidth = window.matchMedia('(max-width: 460px)')\n  let showMore = false\n  export let clave\n\n  onMount(() => {\n    if (clave.guia) {\n      if (screenWidth.matches) {\n        clavis.configure(canvas, clave.guia)\n        clavis.draw(80, 80, 30)\n      } else {\n        clavis.configure(canvas, clave.guia)\n        clavis.draw(200, 200, 80)\n      }\n    }\n  })\n\n  afterUpdate(() => {\n    if (clave.guia) {\n      if (screenWidth.matches) {\n        clavis.configure(canvas, clave.guia)\n        clavis.draw(80, 80, 30)\n      } else {\n        clavis.configure(canvas, clave.guia)\n        clavis.draw(200, 200, 80)\n      }\n    }\n  })\n\n  const handleDetails = () => {\n    if (screenWidth.matches) {\n      showMore = !showMore\n    }\n  }\n</script>\n\n<div class=\"guia\" class:active=\"{showMore}\" on:click=\"{() => handleDetails()}\">\n  <div class=\"body\">\n    <h1>{clave.nome} <small>{clave.pais}</small></h1>\n\n    <canvas bind:this=\"{canvas}\" width=\"{200}\" height=\"{200}\"></canvas>\n\n    {#if clave.texto && !screenWidth.matches}\n      <p class=\"texto\">{clave.texto}</p>\n    {/if}\n  </div>\n\n  {#if showMore}\n    {#if clave.texto}\n      <p class=\"texto\">{clave.texto}</p>\n    {/if}\n    {#if clave.youtube}\n      <iframe\n        width=\"560\"\n        height=\"315\"\n        src=\"{clave.youtube.replace('watch?v=', 'embed/')}\"\n        frameborder=\"0\"\n      ></iframe>\n    {/if}\n  {/if}\n\n  {#if clave.youtube && !screenWidth.matches}\n    <iframe\n      width=\"560\"\n      height=\"315\"\n      src=\"{clave.youtube.replace('watch?v=', 'embed/')}\"\n      frameborder=\"0\"\n    ></iframe>\n  {/if}\n</div>\n",
    "<style>\n  .guias {\n    display: flex;\n    flex-direction: column;\n    padding: 0;\n    flex-shrink: 0;\n    margin: 0;\n    overflow-y: scroll;\n    height: 100vh;\n  }\n\n  .filters {\n    margin: 0;\n    padding: 0;\n    display: flex;\n    border-bottom: 2px solid #eee;\n    position: fixed;\n    background: #fff;\n    width: 100%;\n  }\n\n  .filter {\n    padding: 10px;\n    margin: 0;\n    text-transform: uppercase;\n    color: #8e8e8e;\n  }\n\n  .claves {\n    padding-top: 80px;\n  }\n\n  li {\n    list-style: none;\n    text-align: left;\n    cursor: pointer;\n    padding: 0 10px;\n    height: 40px;\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 9px;\n    justify-content: center;\n  }\n\n  .active {\n    font-weight: bold;\n    border-bottom: 2px solid #8e8e8e;\n  }</style>\n\n<script>\n  import { onMount, onDestroy } from 'svelte'\n  import inView from 'in-view'\n\n  import {\n    claves,\n    routes,\n    filteredRoutes,\n    activeListItem,\n    activeMapItem,\n  } from './store.js'\n  import Guia from './Guia.svelte'\n\n  let list\n  let clavesContainer\n  let activeRoute = 0\n  let filteredData = $claves\n  onMount(async () => {\n    // Set a nicer offset so it's not a hard cutoff\n    inView.offset(300)\n\n    list.addEventListener('scroll', function (e) {\n      // Active list item is top-most fully-visible item\n      const visibleListItems = Array.from(\n        document.getElementsByClassName('item')\n      ).map(inView.is)\n      // Array.indexOf() will give us the first one in list, so the current active item\n\n      const topMostVisible = visibleListItems.indexOf(true)\n      if (topMostVisible !== $activeMapItem) {\n        activeMapItem.set(topMostVisible)\n      }\n    })\n  })\n\n  const handleFilter = async (routeIndex) => {\n    activeRoute = routeIndex\n    const { nome, ...steps } = $routes[routeIndex]\n    const routeSteps = Object.values(steps)\n    filteredData = []\n    routeSteps.forEach((route) =>\n      filteredData.push($claves.find((clave) => clave.id == route))\n    )\n    list.scrollTop = 0\n    filteredRoutes.set(filteredData)\n  }\n\n  // Update list scroll position when active list item is updated via map\n  const unsubscribeActiveListItem = activeListItem.subscribe(\n    (newActiveListItem) => {\n      if (list) {\n        list.scrollTop = document.getElementById(\n          `guia-${newActiveListItem}`\n        ).offsetTop\n      }\n    }\n  )\n\n  onDestroy(unsubscribeActiveListItem)\n</script>\n\n<div class=\"guias\" bind:this=\"{list}\">\n  <ul class=\"filters\">\n    {#each $routes as route, index}\n      <li\n        class=\"filter\"\n        class:active=\"{activeRoute === index}\"\n        on:click=\"{() => handleFilter(index)}\"\n      >\n        {route.nome}\n      </li>\n    {/each}\n  </ul>\n  <div class=\"claves\">\n    {#each filteredData as clave}\n      <div class=\"item\" id=\"guia-{clave.id}\">\n        <Guia clave=\"{clave}\" />\n      </div>\n    {/each}\n  </div>\n</div>\n",
    "<style lang=\"scss\">div {\n  width: 100%;\n  height: 100%; }\n\n/* .map { */\n/*   width: 100%; */\n/*   height: 100%; */\n/*   div { */\n/*     width: 100%; */\n/*     height: 100%; */\n/*   } */\n/* } */\n.info {\n  position: absolute;\n  bottom: 0;\n  height: 80px;\n  display: block;\n  left: 0;\n  right: 0;\n  background: white;\n  z-index: 2; }\n  .info .body {\n    padding: 0 20px;\n    display: flex; }\n\n/* div:before { */\n/*   box-shadow: 20px 0 10px -10px rgba(0, 0, 0, 0.15) inset; */\n/*   content: ''; */\n/*   height: 100%; */\n/*   left: 0; */\n/*   position: absolute; */\n/*   width: 20px; */\n/*   z-index: 1000; */\n/* } */</style>\n\n<script>\n  import { onMount, onDestroy } from 'svelte'\n  import { mapbox, key } from './mapbox.js'\n  import {\n    claves,\n    filteredRoutes,\n    activeListItem,\n    activeMapItem,\n  } from './store.js'\n  import { isLatitude, isLongitude } from './utils.js'\n  import Guia from './Guia.svelte'\n  console.log('filteredRoutes', $filteredRoutes)\n  let container\n  let map\n  let screenWidth = window.matchMedia('(max-width: 460px)')\n  let clickedItem\n  let showDetails = false\n\n  function generateRoute(route) {\n    const { nome, ...steps } = route\n    let places = Object.values(steps)\n    let coords = []\n    places.forEach((place) => {\n      const { lat, log } = place\n      coords.push([log, lat])\n    })\n\n    return coords\n  }\n\n  function generateFeature({ id, nome, pais, lat, log, guia, texto, youtube }) {\n    if (isLatitude(lat) && isLongitude(log)) {\n      return {\n        type: 'Feature',\n        properties: {\n          nome,\n          pais,\n          id,\n          guia,\n          texto,\n          youtube,\n        },\n        geometry: {\n          type: 'Point',\n          coordinates: [log, lat],\n        },\n      }\n    } else {\n      return {}\n    }\n  }\n\n  onMount(async () => {\n    map = new mapbox.Map({\n      container,\n      style: 'mapbox://styles/guerrinha/ckc70179o1sae1ip67q6upbgg',\n      center: [parseFloat($claves[0].lat), parseFloat($claves[0].log)],\n      zoom: screenWidth.matches ? 0 : 5,\n    })\n\n    map.on('load', function () {\n      map.addLayer({\n        id: 'places',\n        type: 'symbol',\n        source: {\n          type: 'geojson',\n          data: {\n            type: 'FeatureCollection',\n            features: $filteredRoutes.map(generateFeature),\n          },\n        },\n        layout: {\n          'icon-image': 'marker-15',\n          'icon-size': 3,\n          'icon-allow-overlap': true,\n        },\n      })\n\n      map.addLayer({\n        id: 'routes',\n        type: 'line',\n        source: {\n          type: 'geojson',\n          data: {\n            type: 'Feature',\n            properties: {},\n            geometry: {\n              type: 'LineString',\n              coordinates: generateRoute($filteredRoutes),\n            },\n          },\n        },\n        layout: {\n          'line-cap': 'round',\n          'line-join': 'round',\n        },\n        paint: {\n          'line-color': '#fff',\n          'line-width': 2,\n          'line-opacity': 0.8,\n        },\n      })\n    })\n\n    map.on('click', 'places', function ({ features }) {\n      const match = features[0]\n      const coordinates = match.geometry.coordinates.slice()\n      if (isLatitude(coordinates[0]) && isLongitude(coordinates[1])) {\n        showDetails = true\n        clickedItem = match.properties\n        console.log('clickedItem', clickedItem)\n        activeListItem.set(match.properties.id)\n      }\n    })\n\n    map.on('mouseenter', 'places', function () {\n      map.getCanvas().style.cursor = 'pointer'\n    })\n\n    map.on('mouseleave', 'places', function () {\n      map.getCanvas().style.cursor = ''\n    })\n  })\n\n  // Update map center when active list item is updated via list\n  const unsubscribeActiveMapItem = activeMapItem.subscribe(\n    (newActiveMapItem) => {\n      const item = $filteredRoutes[newActiveMapItem]\n      if (map && isLatitude(item.lat) && isLongitude(item.log)) {\n        map.flyTo({\n          center: [item.log, item.lat],\n          zoom: 4,\n        })\n      }\n    }\n  )\n\n  const unsubscribeSelectedRoute = filteredRoutes.subscribe(\n    async (newRoute) => {\n      if (newRoute && map) {\n        const newData = {\n          type: 'FeatureCollection',\n          features: newRoute.map(generateFeature),\n        }\n        const newRoutes = {\n          type: 'Feature',\n          properties: {},\n          geometry: {\n            type: 'LineString',\n            coordinates: generateRoute(newRoute),\n          },\n        }\n\n        map.getSource('routes').setData(newRoutes)\n        map.getSource('places').setData(newData)\n        const item = newRoute[0]\n        map.flyTo({\n          center: [item.log, item.lat],\n          zoom: 4,\n        })\n      }\n    }\n  )\n\n  onDestroy(unsubscribeActiveMapItem, unsubscribeSelectedRoute)\n</script>\n\n<div class=\"map\" bind:this=\"{container}\"></div>\n\n{#if showDetails && screenWidth.matches}\n  <Guia clave=\"{clickedItem}\" />\n{/if}\n"
  ],
  "names": [],
  "mappings": "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"
}